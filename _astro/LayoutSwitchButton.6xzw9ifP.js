import{o as w,i as E,b as z}from"./lifecycle.BXe8Dhbv.js";import{c as C,f as I,a as l,p as H,b as x,h,m as g,g as n,k as M,u as B,d as T,e as V,r as j,t as F,o as W,a7 as y}from"./utils.C-MSO5Ew.js";import{i as L}from"./if.DWTK_nJS.js";import{p as q}from"./props.BKgP4o9g.js";import{s as f}from"./config.DdzV4bgS.js";var A=y('<svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M4 6h16v2H4zm0 5h16v2H4zm0 5h16v2H4z"></path></svg>'),D=y('<svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M3 3h7v7H3V3zm0 11h7v7H3v-7zm11-11h7v7h-7V3zm0 11h7v7h-7v-7z"></path></svg>'),G=T('<button aria-label="切换文章列表布局" class="btn-plain scale-animation rounded-lg h-11 w-11 active:scale-90 flex items-center justify-center"><!></button>');function Q(_,p){x(p,!1);let s=q(p,"currentLayout",12,"list"),r=g(!1),i=g(!1);function u(){h(i,window.innerWidth<1200),n(i)&&s("list")}w(()=>{h(r,!0),u();const t=localStorage.getItem("postListLayout");return t&&(t==="list"||t==="grid")&&s(t),window.addEventListener("resize",u),()=>{window.removeEventListener("resize",u)}});function b(){if(!n(r)||n(i))return;s(s()==="list"?"grid":"list"),localStorage.setItem("postListLayout",s());const t=new CustomEvent("layoutChange",{detail:{layout:s()}});window.dispatchEvent(t)}w(()=>{const t=e=>{s(e.detail.layout)};return window.addEventListener("layoutChange",t),()=>{window.removeEventListener("layoutChange",t)}}),w(()=>{const t=o=>{s(o.detail.layout)},e=()=>{setTimeout(()=>{console.log("Swup event - syncing layout state");const o=localStorage.getItem("postListLayout");if(o&&(o==="list"||o==="grid"))s(o);else{const c=f.postListLayout.defaultMode;s(c)}},200)};window.addEventListener("layoutInit",t);function d(){if(typeof window<"u"&&window.swup){const o=window.swup;o.hooks.on("content:replace",e),o.hooks.on("page:view",e),o.hooks.on("animation:in:end",e),console.log("Swup button listeners registered")}else window.addEventListener("popstate",e),console.log("Fallback button listeners registered")}return setTimeout(d,200),()=>{if(window.removeEventListener("layoutInit",t),typeof window<"u"&&window.swup){const o=window.swup;o.hooks.off("content:replace",e),o.hooks.off("page:view",e),o.hooks.off("animation:in:end",e)}else window.removeEventListener("popstate",e)}}),E();var m=C(),S=I(m);{var k=t=>{var e=G(),d=V(e);{var o=a=>{var v=A();l(a,v)},c=a=>{var v=D();l(a,v)};L(d,a=>{s()==="list"?a(o):a(c,!1)})}j(e),F(()=>z(e,"title",s()==="list"?"切换到网格模式":"切换到列表模式")),W("click",e,b),l(t,e)};L(S,t=>{n(r),M(f),n(i),B(()=>n(r)&&f.postListLayout.allowSwitch&&!n(i))&&t(k)})}l(_,m),H()}export{Q as default};
